{% extends 'base.html' %}

{% block navbar %}
    <ul class="navbar-nav mt-3">
      <li class="navbar-item"><a class="navbar-brand me-2" style="color: FFFFFF">This is Branding</a></li>
      <li class="navbar-item"><a class="me-2" style="color: F8F9FA" href="{% url 'dashboard' %}">Dashboard (current)</a></li>
      <li class="navbar-item"><a class="me-2" style="color: ADB5BD" href="{% url 'view_members' %}">Members</a></li>
      <li class="navbar-item"><a class="me-2" style="color: ADB5BD" href="{% url 'view_project' %}">Overview</a></li>
      <!-- TODO: Logout -->
      <li><a class="mr-2" style="color: ADB5BD" href="">Logout</a></li>
    </ul>
{% endblock %}

{% block content %}
    <h1 class="ms-3" style="color: WHITE;">{{ project.project_name }}</h1>
    <div class="mb-3" style="height: 1px; background-color: #EAEFF5"></div>
    <!-- line break -->

    <!-- Tasks list -->
    <div id="tasksList">
        <h2 class="ms-3"style="color: WHITE">
            Tasks
            <button id="tasksCreateBtn" onclick="toggleForm('tasks')">+</button>
        </h2>
        <div class="mb-3 ms-3" style="height: 1px; width: 93%; background-color: #EAEFF5"></div>
        <!-- line break --> 
      {% for task in tasks %}
        <table class="table table-success ms-4 rounded-3 overflow-hidden" style="width: 90%;">
          <tr>
            <td>{{ task.task_name }}</td>                 
            <td class="table table-light" style="width:80%">
              <table style="text-align: left;" class="table table-light">
                <tr>
                  <th>Status: {{ task.get_task_status_display}} </th>
                </tr>
                <tr>
                  <th>Priority: {{ task.get_task_priority_displays}} </th>
                </tr>
                <tr>
                  <th>Notes: {{ task.task_notes|linebreaks }} </th>
                </tr>
                <tr>
                  <th>Deadline: {{ task.task_deadline }} </th>
                  <!-- IDK how to get rid of the annoying thing here -->
                </tr>
              </table>
            </td>
          </tr>

        </table>
      {% endfor %}
    </div>

    <!-- New task form -->
    <div id="tasksForm">
        <h2>New Task</h2>
        <div class="mb-3 ms-3" style="height: 1px; width: 93%; background-color: #EAEFF5"></div>
        <!-- line break --> 
        <form action="{% url 'create_task' %}" method="POST">{% csrf_token %}
            <label for="task_name">Task Name:</label>
            <input type="text" name="task_name" id="task_name" required><br><br>

            <label for="task_notes">Task Notes:</label>
            <textarea name="task_notes" id="task_notes" cols="30" rows="10"></textarea><br><br>

            <label>Task Priority:</label>
            <input type="radio" id="task_priority_l" name="task_priority" value="L" required>
            <label for="task_priority_l">Low</label>
            <input type="radio" id="task_priority_m" name="task_priority" value="M" required>
            <label for="task_priority_m">Medium</label>
            <input type="radio" id="task_priority_h" name="task_priority" value="H" required>
            <label for="task_priority_h">High</label>
            <br><br>

            <label for="task_deadline">Deadline:</label>
            <input type="date" name="task_deadline" id="task_deadline"><br><br>

            <!-- TODO: Task Members-->
            <label for="task_members">Task Members:</label>
            <br><br>

            <input type="submit">
        </form>

        <button onclick="toggleForm('tasks')">Cancel</button>
    </div>

    <!-- New expense form -->
    <div id="expensesForm">
        <h2>New Expense</h2>
        <div class="mb-3 ms-3" style="height: 1px; width: 93%; background-color: #EAEFF5"></div>
        <!-- line break --> 
        <form action="{% url 'create_expense' %}" method="POST">{% csrf_token %}
            <label for="expense_date">Expense date:</label>
            <input type="date" name="expense_date" id="expense_date" required><br><br>

            <label for="expense_desc">Expense Description:</label>
            <textarea name="expense_desc" id="expense_desc" cols="30" rows="10" required></textarea><br><br>

            <label for="expense_amt">Expense Amount:</label>
            <input type="number" name="expense_amt" id="expense_amt" required><br><br>

            <input type="submit">
        </form>

        <button onclick="toggleForm('expenses')">Cancel</button>
    </div>

    <!-- Expenses list -->
    <div id="expensesList">
    <h2 class="mt-2">
        Expenses
        <button id="expensesCreateBtn" onclick="toggleForm('expenses')">+</button>
        <div class="mb-3 ms-3" style="height: 1px; width: 93%; background-color: #EAEFF5"></div>
        <!-- line break --> 
    </h2>
            {% for expense in expenses %}
                <li><b>{{ expense.expense_desc }}</b>
                    <ul>
                        <li>Expense by: {{ expense.member_id.user_id.name }}</li>
                        <li>Amount: Php {{ expense.expense_amt }}</li>
                        <li>Date: {{ expense.expense_date }}</li>
                    </ul>
                </li>
            {% endfor %}
    </div>


{% endblock %}
